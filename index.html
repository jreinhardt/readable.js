<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8"/>
		<script src="http://code.jquery.com/jquery-1.8.3.min.js" type="text/javascript"></script>
		<script src="raphael-2.1.0-min.js" type="text/javascript"></script>
		<script src="readable.js" type="text/javascript"></script>

		<script type="text/javascript">


			/*
			Auto-update with typing time-out.
			*/
			var autoUpdateTimer;
			var AUTO_UPDATE_TIMEOUT = 500; // in ms

			$(document).ready(function() {
				$('#text').on('input paste', function() {
					clearTimeout(autoUpdateTimer);
					if ($('#text').val) {
						autoUpdateTimer = setTimeout(update, AUTO_UPDATE_TIMEOUT);
					}
				});
			});

			function clearTable(table) {
				document.getElementById(table).innerHTML = '';
			}

			function addRow(table, label, value) {
				var tr = document.createElement('tr');
				document.getElementById(table).appendChild(tr);
				var td1 = document.createElement('td');
				tr.appendChild(td1);
				$(td1).addClass('label');
				td1.innerHTML = label;
				var td2 = document.createElement('td');
				$(td2).addClass('plot');
				tr.appendChild(td2);
				var p = Raphael(td2, 600, 16);
				var r = p.rect(.5, .5, value, 15);
				r.attr('fill', '#f00');
				r.attr('stroke', '#a00');
			}

			function updateTable(table, values) {
				clearTable(table);
				addRow(table, 'Your Text', values[0]);
				addRow(table, 'Declaration of Independence', values[1]);
				addRow(table, 'I have a Dream', values[2]);
			}

			function update(evt) {
				var text = document.form.text.value;
				var words = split_into_words(text);
				var sentences = split_into_sentences(text);
				var ns = sentences.length;
				var nw = words.length;
				var nc = count_complex_words(words);
				var nl = count_letters(text);
				var nsyl = 0;
				var i;
				for (i = 0; i < words.length; i++) {
					nsyl += count_syllables(words[i]);
				}

				var f = flesh_index(ns, nw, nsyl);
				updateTable('tableFlesch', [f, 5, 5]);

				var cl = coleman_liau_index(ns, nw, nl);
				updateTable('tableColemanLiau', [cl, 5, 5]);

				var ari = automated_readability_index(ns, nw, nl);
				updateTable('tableAutomatedReadability', [ari, 5, 5]);

				var gf = gunning_fog_index(ns, nw, nc);
				updateTable('tableGunningFog', [gf, 5, 5]);

				var smog = smog_grade(ns,nc);
				updateTable('tableSMOG', [smog, 5, 5]);

				document.getElementById("num_syllables").innerHTML = nsyl;
				document.getElementById("num_words").innerHTML = nw;
				document.getElementById("num_complex_words").innerHTML = nc;
				document.getElementById("num_sentences").innerHTML = ns;
				document.getElementById("num_letters").innerHTML = nl;
			}

		</script>


		<style type="text/css">
			table.diagram {
				border-collapse:collapse;
			}

			table.diagram td.label {
				border-width:0 2px 0 0;
				border-color:#aaa;
				border-style:solid;
				padding:0.2em;
				text-align:right;
			}

			table.diagram td.plot {
				padding:0.2em;
			}
		</style>
	</head>

	<body>
		<!-- Javascript support check -->
		<div id="no_javascript" style="border:1px solid #f00;">This site requires JavaScript. Please enable JavaScript-support in your browser.</div>
		<script type="text/javascript">
			element = document.getElementById("no_javascript");
			element.parentNode.removeChild(element);
		</script>

		<h1>Your Text</h1>
		<form name="form">
			<textarea name="text" id="text" cols="80" rows="10"></textarea>
		</form>

		<h1>Basic Stats</h1>
		<table>
			<tr><th>Number of syllables</th><td id="num_syllables">0</td></tr>
			<tr><th>Number of words</th><td id="num_words">0</td></tr>
			<tr><th>Number of complex words</th><td id="num_complex_words">0</td></tr>
			<tr><th>Number of sentences</th><td id="num_sentences">0</td></tr>
			<tr><th>Number of letters</th><td id="num_letters">0</td></tr>
		</table>

		<h1>Flesch Index</h1>
		<p>The Flesch index is an uber way to check the readability of your text. <a href="http://en.wikipedia.org/wiki/Flesch_index">Read more</a>.</p>
		<table id="tableFlesch" class="diagram"></table>

		<h1>Coleman-Liau Index</h1>
		<p>The Coleman-Liau index is an uber way to check the readability of your text. <a href="http://en.wikipedia.org/wiki/Coleman-Liau_index">Read more</a>.</p>
		<table id="tableColemanLiau" class="diagram"></table>

		<h1>Automated Readability Index</h1>
		<p>The Automated Readability Index is an uber way to check the readability of your text. <a href="http://en.wikipedia.org/wiki/Automated_Readability_Index">Read more</a>.</p>
		<table id="tableAutomatedReadability" class="diagram"></table>

		<h1>Gunning-Fog Index</h1>
		<p>The Gunning-Fog index is an uber way to check the readability of your text. <a href="http://en.wikipedia.org/wiki/Gunning-Fog_index">Read more</a>.</p>
		<table id="tableGunningFog" class="diagram"></table>

		<h1>SMOG Grade</h1>
		<p>The SMOG grade is an uber way to check the readability of your text. <a href="http://en.wikipedia.org/wiki/SMOG">Read more</a>.</p>
		<table id="tableSMOG" class="diagram"></table>

	</body>
</html>
