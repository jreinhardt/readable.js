<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8"/>
		<script src="http://code.jquery.com/jquery-1.8.3.min.js" type="text/javascript"></script>
		<script src="raphael-2.1.0-min.js" type="text/javascript"></script>
		<script src="readable.js" type="text/javascript"></script>

		<script type="text/javascript">

			REFERENCES = [
				{name: 'Declaration of Independence', values: [48.1, 12.0, 13.9, 14.9, 13.3]},
				{name: 'Alice in Wonderland', values: [80.8, 5.7, 6.0, 8.6, 7.7]},
				{name: 'I have a Dream', values: [67.7, 8.0, 8.3, 11.2, 10.6]},
				{name: 'Critique of pure Reason', values: [47.8, 11.7, 12.8, 14.6, 13.3]},
				{name: 'Typical "The Sun" Article', values: [78.1, 6.7, 5.0, 8.0, 8.5]}
			]

			/*
			Auto-update with typing time-out.
			*/
			var autoUpdateTimer;
			var AUTO_UPDATE_TIMEOUT = 500; // in ms

			$(document).ready(function() {
				$('#text').on('input paste', function() {
					clearTimeout(autoUpdateTimer);
					if ($('#text').val) {
						autoUpdateTimer = setTimeout(update, AUTO_UPDATE_TIMEOUT);
					}
				});
			});

			function clearTable(table) {
				document.getElementById(table).innerHTML = '';
			}

			function addRow(table, label, value, fill, stroke) {
				var tr = document.createElement('tr');
				document.getElementById(table).appendChild(tr);
				var td1 = document.createElement('td');
				tr.appendChild(td1);
				$(td1).addClass('label');
				td1.innerHTML = label;
				var td2 = document.createElement('td');
				$(td2).addClass('plot');
				tr.appendChild(td2);
				var p = Raphael(td2, 300, 16);
				var r = p.rect(.5, .5, Math.max(value, 5), 15); // Make sure value is not too small, looks strange in GUI.
				r.attr('fill', fill);
				r.attr('stroke', stroke);
			}

			function updateTable(table, value, j, scale) {
				clearTable(table);
				addRow(table, 'Your Text', value * scale, '#71D0F0', '#3C6F80');
				for (var i = 0; i < REFERENCES.length; i++) {
					addRow(table, REFERENCES[i].name, REFERENCES[i].values[j] * scale, '#ddd', '#aaa');
				}
			}

			function update(evt) {
				var text = Text(document.form.text.value);

				updateTable('tableFlesch', text.getFleschKincaidIndex(), 0, 2);
				updateTable('tableColemanLiau', text.getColemanLiauIndex(), 1, 15);
				updateTable('tableAutomatedReadability', text.getAutomatedReadabilityIndex(), 2, 15);
				updateTable('tableGunningFog', text.getGunningFogIndex(), 3, 15);
				updateTable('tableSMOG', text.getSmogGrade(), 4, 15);

				$('#results').show();
			}

		</script>


		<style type="text/css">

			#content {
				width:600px;
				margin:0 auto 0 auto;
			}

			/* Styles for bar chars */
			table.diagram {
				border-collapse:collapse;
			}

			table.diagram td.label {
				border-width:0 2px 0 0;
				border-color:#aaa;
				border-style:solid;
				padding:0.2em;
				text-align:right;
				vertical-align:middle;
			}

			table.diagram td.plot {
				padding:0.2em;
			}
		</style>
	</head>

	<body>

		<div id="content" style="display:none;">

			<h1>readable.js</h1>

			<p><i>readable.js</i> is a Javascript library for
			readability analysis. Get it <a href="http://www.github.com/jreinhardt/readable.js">on github</a>.</p>

			<h2>Try it now!</h2>
			<p>Type or paste a text and see how readable it is compared to other
			texts:</p>
			<form name="form">
				<textarea name="text" id="text" cols="80" rows="10"></textarea>
			</form>

			<div id="results" style="display:none;">
				<h2>Flesch Reading Ease</h2>
				<p>The Flesch Reading Ease test depends on the number of words per
				sentence and the number of syllables per word. Higher values indicate
				a better readability.
				<a href="http://en.wikipedia.org/wiki/Fleschâ€“Kincaid_Readability_Test">Read more</a>.</p>
				<table id="tableFlesch" class="diagram"></table>

				<h2>Coleman-Liau Index</h2>
				<p>The Coleman-Liau index depends on the length of the words and the
				number of words per sentence. Lower values indicate a better readability.
				<a href="http://en.wikipedia.org/wiki/Coleman-Liau_index">Read more</a>.</p>
				<table id="tableColemanLiau" class="diagram"></table>

				<h2>Automated Readability Index</h2>
				<p>The Automated Readability Index depends on length of the words and
				the number of words per sentence. Lower values indicate a better readability.
				<a href="http://en.wikipedia.org/wiki/Automated_Readability_Index">Read more</a>.</p>
				<table id="tableAutomatedReadability" class="diagram"></table>

				<h2>Gunning-Fog Index</h2>
				<p>The Gunning-Fog index depends on the number of words per sentence and
				the number of complex words. Lower values indicate a better readability.
				<a href="http://en.wikipedia.org/wiki/Gunning-Fog_Index">Read more</a>.</p>
				<table id="tableGunningFog" class="diagram"></table>

				<h2>SMOG Grade</h2>
				<p>The SMOG grade depends on the number of complex words per sentence.
				Lower values indicate a better readability.
				<a href="http://en.wikipedia.org/wiki/SMOG">Read more</a>.</p>
				<table id="tableSMOG" class="diagram"></table>
			</div>
		</div>

		<!-- Javascript support check -->
		<div id="no_javascript" style="border:1px solid #f00;">This site requires JavaScript. Please enable JavaScript-support in your browser.</div>
		<script type="text/javascript">
			element = document.getElementById("no_javascript");
			element.parentNode.removeChild(element);
			$('#content').show();
		</script>

	</body>
</html>
